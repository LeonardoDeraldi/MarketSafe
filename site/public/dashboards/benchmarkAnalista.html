<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MarketSafe | Dashboard</title>
    <link rel="stylesheet" href="/css/dashboards/dash_benchmark_analista.css" />
    <link rel="icon" href="css/icon.png" />
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://kit.fontawesome.com/9f7414eb10.js" crossorigin="anonymous"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Abel&family=Afacad:ital,wght@0,400..700;1,400..700&display=swap"
        rel="stylesheet">

    <script src="/js/heatmap.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div class="container">
        <div class="menu">
            <div class="div_logo">
                <img src="/assets/img/Logo Self 2.png" alt="">
                <div class="MKTS">
                    <h1>MKTS</h1>
                </div>
            </div>
            <div class="select_dash">
                <h2>Dashboards</h2>
            </div>
            <div class="regiao-select">
                <div class="analista">
                    <h3>Analista</h3>
                </div>
                <div class="monitoramento">
                    <p>Monitoramento</p> <i class='bx bx-show'></i>
                </div>
                <div class="monitoramento">
                    <p>Histórico</p> <i class='bx bx-file-blank'></i>
                </div>
                <div class="monitoramento">
                    <p>BenchMark</p> <i class="fa-solid fa-scale-balanced"></i>
                </div>
            </div>
            <div class="linha">
            </div>
            <div class="perfil">
                <div class="foto_perfil">
                    <img src="/css/foto-anilista.jpg" alt="">
                </div>
                <div class="nome_perfil">
                    <div class="nome">
                        <h2>Fred</h2>
                    </div>
                    <hr>
                    <div class="cargo">
                        <p>Analista</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="dashes">

            <!-- Tela de Benchmark para o analista -->
            <div class="benchAnalista">
                <div class="titulo" id="tituloBenchmark">
                    <h1>Menu de Seleção - BenchMark</h1>
                </div>
                <div class="filtros" id="filtrosBenchmark">
                    <div class="selecoes">
                        <div class="fComp">
                            <h2>Componente</h2>
                            <div class="buttons">
                                <button onclick="selecionarCmp(1)" id="btCPU">
                                    <h2>CPU</h2>
                                </button>
                                <button onclick="selecionarCmp(2)" id="btRAM">
                                    <h2>RAM</h2>
                                </button>
                            </div>
                        </div>
                        <div class="fTote">
                            <h2>Totens</h2>
                            <div class="fSelect">
                                <select name="" id="totem_select1">
                                    <option value="#">Escolha um Totem</option>
                                    <option value="1">Totem 1</option>
                                    <option value="2">Totem 2</option>
                                </select>
                                <select name="" id="totem_select2">
                                    <option value="#">Escolha um Totem</option>
                                    <option value="1">Totem 1</option>
                                    <option value="2">Totem 2</option>
                                </select>

                            </div>
                        </div>

                        <div class="fPeri">
                            <h2>Período</h2>
                            <div class="datas">
                                <input type="date" id="periodoInicio">
                                <input type="date" id="periodoFim">
                            </div>
                        </div>

                    </div>
                    <div class="btFiltro" id="btFiltrar">
                        <button class="comparacao" onclick="trocarTela()">Comparar</button>
                    </div>
                </div>
                <div class="conteudo" id="ctd1">
                    <div class="ctdEsq">
                        <h2>Fluxo Mensal</h2>
                        <div class="heatmap"></div>
                    </div>
                    <div class="ctdDir">
                        <h2>Sugestões de Filtros <br> (Mensal)</h2>
                        <div class="sug" style="margin-top: 5%;" onclick="filtrarAuto()">
                            <div>
                                <h3>Componente: RAM</h3>
                                <h3>Totens: <span id="sgtTM"></span> e <span id="sgtMN"></span></h3>
                            </div>
                            <svg xmlns="http://www.w3.org/2000/svg" width="0.5em" height="1em" viewBox="0 0 12 24">
                                <defs>
                                    <path id="weuiArrowOutlined0" fill="white"
                                        d="m7.588 12.43l-1.061 1.06L.748 7.713a.996.996 0 0 1 0-1.413L6.527.52l1.06 1.06l-5.424 5.425z" />
                                </defs>
                                <use fill-rule="evenodd" href="#weuiArrowOutlined0"
                                    transform="rotate(-180 5.02 9.505)" />
                            </svg>
                        </div>
                        <div class="sug">
                            <div>
                                <h3>Componente: RAM</h3>
                                <h3>Totens: 3 e 6</h3>
                            </div>
                            <svg xmlns="http://www.w3.org/2000/svg" width="0.5em" height="1em" viewBox="0 0 12 24">
                                <defs>
                                    <path id="weuiArrowOutlined0" fill="white"
                                        d="m7.588 12.43l-1.061 1.06L.748 7.713a.996.996 0 0 1 0-1.413L6.527.52l1.06 1.06l-5.424 5.425z" />
                                </defs>
                                <use fill-rule="evenodd" href="#weuiArrowOutlined0"
                                    transform="rotate(-180 5.02 9.505)" />
                            </svg>
                        </div>
                        <div class="sug">
                            <div>
                                <h3>Componente: CPU</h3>
                                <h3>Totens: 3 e 4</h3>
                            </div>
                            <svg xmlns="http://www.w3.org/2000/svg" width="0.5em" height="1em" viewBox="0 0 12 24">
                                <defs>
                                    <path id="weuiArrowOutlined0" fill="white"
                                        d="m7.588 12.43l-1.061 1.06L.748 7.713a.996.996 0 0 1 0-1.413L6.527.52l1.06 1.06l-5.424 5.425z" />
                                </defs>
                                <use fill-rule="evenodd" href="#weuiArrowOutlined0"
                                    transform="rotate(-180 5.02 9.505)" />
                            </svg>
                        </div>
                    </div>
                </div>
                <div class="conteudo2" id="ctd2" style="display: none;">
                    <div class="ctdEsq">
                        <h1 class="tituloLinha"> Alertas x Totem em horários nos dias da semana </h1>
                        <div class="GfLinha">
                            <canvas id="lineChart"></canvas>
                        </div>
                        <div class="DBSlider">
                            <h3>Horário:</h3>
                            <div class="filtrosSL">
                                <div class="wrapper">
                                    <div class="sliderContainer">
                                        <div class="slider-track"></div>
                                        <input type="range" min="0" max="24" value="1" id="slider-1"
                                            oninput="slideOne()" onmouseup="atualizarDadosT1(), atualizarDadosT2()"/>
                                        <input type="range" min="0" max="24" value="12" id="slider-2"
                                            oninput="slideTwo()" onmouseup="atualizarDadosT1(), atualizarDadosT2()"/>
                                        <!-- <input type="range" min="0" max="23" value="10" id="slider-1" oninput="slideOne(), atualizarFeed()"> -->
                                        <!-- <input type="range" min="0" max="23" value="12" id="slider-2" oninput="slideTwo(), atualizarFeed()"> -->
                                    </div>
                                    <div class="values">
                                        <span id="range1"> 0 </span>
                                        <span> &ThickSpace; &dash; &ThickSpace; </span>
                                        <span id="range2"> 12 </span>
                                    </div>  
                                </div>
                            </div>
                        </div>
                        <div class="divisao"></div>
                        <h1 class="tituloBarra"> Alertas por Dia </h1>
                        <div class="GfBar">
                            <canvas id="barChart" width="800"></canvas>
                        </div>

                    </div>
                    <div class="ctdDir">
                        <h1 class="tituloRsq"> Tempo de atividade dos totens x status </h1>
                        <div class="graficoRosquina">
                            <div class="graficoRsq1">
                                <canvas id="donut1"></canvas>
                            </div>
                            <div class="graficoRsq2">
                                <canvas id="donut2"></canvas>
                            </div>
                        </div>
                        <div class="labelsRsq">
                            <div
                                style="height: 20px; width: 20px; background-color: rgb(150, 147, 147); margin-right: 5px; border: #FFF solid 2px;">
                            </div>
                            <h3>Ineficiente</h3>
                            <div
                                style="height: 20px; width: 20px; background-color: rgb(48, 170, 48); margin-right: 5px; border: #FFF solid 2px;">
                            </div>
                            <h3>Ideal</h3>
                            <div
                                style="height: 20px; width: 20px; background-color: #FF3131; margin-right: 5px; border: #FFF solid 2px;">
                            </div>
                            <h3>Crítico</h3>
                        </div>
                        <div class="divisao"></div>
                        <div style="text-align: center; width: 90%;">
                            <h1>Dados dos alertas</h1>
                            <div>
                                <h3><span class="txt">Relação entre alertas totais</span></h3>
                                <div style="display: flex; justify-content: space-between;">
                                    <h3 id="alertasT1Total"></h3>
                                    <div class="comparacao">
                                        <div class="barra1" id="barra1"></div>
                                        <div class="barra2" id="barra2"></div>
                                    </div>
                                    <h3 id="alertasT2Total"></h3>
                                </div>

                                <h3><span class="txt">Relação entre alertas de <span id="compSelecionadoParaAlertas">RAM</span></span></h3>
                                <div style="display: flex; justify-content: space-between;">
                                    <h3 id="alertasT1Cmp"></h3>
                                    <div class="comparacao">
                                        <div class="barra1" id="barra3"></div>
                                        <div class="barra2" id="barra4"></div>
                                    </div>
                                    <h3 id="alertasT2Cmp"></h3>
                                </div>
                                <div class="labelsAlerta">
                                    <div
                                        style="height: 20px; width: 20px; background-color: #FF6F16; margin-right: 5px; border: #FFF solid 2px;">
                                    </div>
                                    <h3>Totem 1</h3>
                                    <div
                                        style="height: 20px; width: 20px; background-color: #FFB418; margin-right: 5px; border: #FFF solid 2px;">
                                    </div>
                                    <h3>Totem 2</h3>
                                </div>
                            </div>

                        </div>
                    </div>

                </div>

            </div>
        </div>

    </div>
</body>

</html>

<script>

    var maiorTotem
    var menorTotem

    var minInd
    var mxInd

    var heatmapInstance = h337.create({
        container: document.querySelector(".heatmap"),
    });

    var points = [];
    var max = 60;
    var min = 0;
    var width = 850;
    var height = 490;

    var contResultado = 0;

    puxarDadosBucket();

    puxarTodosAlertas();

    function atualizarFeed() {
        // =========================================================================

        var dado = 25;

        var escada1 = { x: 38, y: 340, value: dado * 0.7, radius: 40, };
        var escada2 = { x: 90, y: 340, value: dado * 0.5, radius: 40, };
        //    var escada3 = { x: 545, y: 345, value: dado, radius: 40, };
        //    var passarela1 = { x: 515, y: 370, value: dado * 1.2, radius: 40, };
        //    var passarela2 = { x: 620, y: 250, value: dado * 1, radius: 40, };
        //    var catraca = { x: 690, y: 172, value: dado * 0.8, radius: 40, };

        points = [escada1, escada2];

        var data = {
            max: max,
            min: min,
            data: points,
        }

        heatmapInstance.setData(data);

        // ========================================================================

    }

    componente = "nulo"

    function selecionarCmp(param) {
        if (param == 1){
            btCPU.style.backgroundColor = "#E9864A"
            btCPU.style.borderColor = "#FF6000"

            btRAM.style.backgroundColor = "#3A3B47"
            btRAM.style.borderColor = "#4E4E4E"

            btRAM.style.opacity = "0.5" 
            btCPU.style.opacity = "1" 

            componente = "cpu"
        }
        else if (param == 2){
            btRAM.style.backgroundColor = "#E9864A"
            btRAM.style.borderColor = "#FF6000"

            btCPU.style.backgroundColor = "#3A3B47"
            btCPU.style.borderColor = "#4E4E4E"

            btCPU.style.opacity = "0.5"
            btRAM.style.opacity = "1"

            componente = "ram"
        }
    }


    function trocarTela() {
        prInicio = periodoInicio.value
        prFim = periodoFim.value
        

        totem1 = totem_select1.value;
        totem2 = totem_select2.value;

        if(componente == "nulo" || totem1 == "#" || totem2 == "#" || prInicio == "" || prFim == ""){
            alert("Atenção, todos os itens do filtro devem ser preenchidos")
        } else {
            alimentarGraficos()

            ctd1.style.display = 'none'
            ctd2.style.display = 'flex'

            btFiltrar.style.display = 'none'

            filtrosBenchmark.style.marginTop = '0%'
            filtrosBenchmark.style.paddingTop = '0%'
            filtrosBenchmark.style.borderRadius = '0px 0px 10px 10px'
            tituloBenchmark.style.borderRadius = '10px 10px 0px 0px'

            tituloBenchmark.innerHTML = "<h1>BenchMark</h1>"

            var date = periodoInicio.value.split("-");
            dayI = date[2];

            var dateD = periodoFim.value.split("-");
            dayF = dateD[2];

            var rangeDias = [];
            var cont = 0;

            for (let i = dayI; i <= dayF; i++){
                rangeDias[cont] = i
                cont = cont + 1;
            }
            
            ctx2.data.labels = rangeDias;
            ctx2.update();
        }
    }

    function alimentarGraficos() {

        totem1 = totem_select1.value;
        totem2 = totem_select2.value;

        atualizarDadosT1()

        atualizarDadosT2()

        puxarAlertasPorDia()

        puxarAlertasPorDia2()

        puxarTodosAlertas();
        puxarTodosAlertasPorTotem();

        setTimeout(() => graficoBarrasHorizontal(), 500);

        puxarDadosBucket()

    }



    // Grafico de linha 

    // const ctx = document.getElementById('lineChart');

    const labels = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sab']

    const data = {
            labels: labels,
            datasets: [{
                label: 'Totem 1',
                data: [65, 59, 80, 81, 56, 55, 40],
                borderColor: '#9D3C00',
                backgroundColor: '#FF6F16',
                tension: 0

            },
            {
                label: 'Totem 2',
                data: [55, 49, 80, 21, 46, 35, 50],
                borderColor: '#C98800',
                backgroundColor: '#FFB418',
                tension: 0
            }]
        };

    const config = {
        type: 'line',
        data: data,
        options: {
            maintainAspectRatio: false,
            scales: {
                x: {
                    beginAtZero: true,
                    ticks: {
                        color: 'rgba(255, 255, 255, 0.90)'
                    },
                }, y: {
                    min: 0,
                    ticks: {
                        color: 'rgba(255, 255, 255, 0.90)'
                    },
                }
            },
            plugins: {
                legend: {
                    position: 'right',
                    labels: {
                        color: 'white',
                        padding: 25,
                        boxWidth: 20,
                        boxHeight: 20
                    },
                }
            }
        }

    };

    const ctx = new Chart(
        document.getElementById('lineChart'),
        config
    );

    // Grafico de Barras

    const labels2 = ['1', '2', '3', '4', '5', '6', '7'];

    const data2 = {
            labels: labels2,
            datasets: [{
                label: 'Totem 1',
                data: [45, 69, 60, 51, 26, 65, 48],
                backgroundColor: [
                    '#FF6F16',
                    '#FF6F16',
                    '#FF6F16',
                    '#FF6F16',
                    '#FF6F16',
                    '#FF6F16',
                    '#FF6F16'
                ],
                borderColor: [
                    '#9D3C00',
                    '#9D3C00',
                    '#9D3C00',
                    '#9D3C00',
                    '#9D3C00',
                    '#9D3C00',
                    '#9D3C00'
                ],
                borderWidth: 2
            }, {
                label: 'Totem 2',
                data: [65, 59, 80, 81, 56, 55, 40],
                backgroundColor: [
                    '#FFB418',
                    '#FFB418',
                    '#FFB418',
                    '#FFB418',
                    '#FFB418',
                    '#FFB418',
                    '#FFB418'
                ],
                borderColor: [
                    '#C98800',
                    '#C98800',
                    '#C98800',
                    '#C98800',
                    '#C98800',
                    '#C98800',
                    '#C98800'
                ],
                borderWidth: 2
            }]
        };

    const config2 = {
        type: 'bar',
        data: data2,
        options: {
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        color: 'rgba(255, 255, 255, 0.90)'
                    },
                    title: {
                        display: true,
                        text: "Alertas",
                        color:  'rgba(255, 255, 255, 0.90)'
                    }
                },
                x: {
                    beginAtZero: true,
                    ticks: {
                        color: 'rgba(255, 255, 255, 0.90)'
                    },
                    title: {
                        display: true,
                        text: "Dias",
                        color:  'rgba(255, 255, 255, 0.90)'
                    }
                }
            },
            plugins: {
                legend: {
                    position: 'right',
                    labels: {
                        color: 'white',
                        padding: 25,
                        boxWidth: 20,
                        boxHeight: 20
                    },
                }
            },
            maintainAspectRatio: false
        }
    };

    const ctx2 = new Chart(
        document.getElementById('barChart'),
        config2
    );

    // Grafico de Rosquina 1
    labelsRsq = ["Ineficiente", "Ideal", "Crítico"]

    const data3 = {
            labels: labelsRsq,
            datasets: [{
                data: [50, 300, 100],
                backgroundColor: [
                    'rgb(150, 147, 147)',  // cinza
                    'rgb(48, 170, 48)',  // verde
                    '#FF3131' // vermelho
                ],
                hoverOffset: 4,
                borderWidth: 1
            }]
        };

    const config3 = {
        type: 'doughnut',
        data: data3,
        options: {
            plugins: {
                legend: {
                    display: false,
                }, 
                title: {
                display: true,
                text: 'Totem 1',
                color: 'white',
                font: {
                        size: 15
                    }
                }
            }
        }
    };

    const ctx3 = new Chart(
        document.getElementById('donut1'),
        config3
    );

    // Grafico de Rosquina 2

    const data4 = {
            labels: labelsRsq,
            datasets: [{
                data: [70, 240, 170],
                backgroundColor: [
                    'rgb(150, 147, 147)',
                    'rgb(48, 170, 48)',
                    '#FF3131'
                ],
                hoverOffset: 4,
                borderWidth: 1
            }]
        };

    const config4 = {
        type: 'doughnut',
        data: data4,
        options: {
            plugins: {
                legend: {
                    display: false,
                }, 
                title: {
                display: true,
                text: 'Totem 2',
                color: 'white',
                font: {
                        size: 15
                    }
                }
            }
        }
    };

    const ctx4 = new Chart(
        document.getElementById('donut2'),
        config4
    );

    let sliderOne = document.getElementById("slider-1");
    let sliderTwo = document.getElementById("slider-2");
    let displayValOne = document.getElementById("range1");
    let displayValTwo = document.getElementById("range2");
    let minGap = 1;
    let sliderTrack = document.querySelector(".slider-track");
    let sliderMaxValue = document.getElementById("slider-1").max;

    sliderOne.value = 0;
    sliderTwo.value = 24;

    slideOne()
    slideTwo()


    function slideOne(param) {
        if (parseInt(sliderTwo.value) - parseInt(sliderOne.value) <= minGap) {
            sliderOne.value = parseInt(sliderTwo.value) - minGap;
        }
        // if (sliderOne.value < 10) displayValOne.textContent = '0' + sliderOne.value + ':00';
        // else displayValOne.textContent = sliderOne.value + ':00 ';

        displayValOne.textContent = sliderOne.value + ":00";
        fillColor();
    }

    function slideTwo(param) {
        if (parseInt(sliderTwo.value) - parseInt(sliderOne.value) <= minGap) {
            sliderTwo.value = parseInt(sliderOne.value) + minGap;
        }
        // if (sliderTwo.value < 10) displayValTwo.textContent = '0' + sliderTwo.value + ':00';
        // else displayValTwo.textContent = sliderTwo.value + ':00';
        displayValTwo.textContent = sliderTwo.value + ":00";
        fillColor();
    }

    function fillColor(param) {
        percent1 = (sliderOne.value / sliderMaxValue) * 100;
        percent2 = (sliderTwo.value / sliderMaxValue) * 100;
        sliderTrack.style.background = `linear-gradient(to right, #3A3B47 ${percent1}% , #D7D7D8 ${percent1}% , #D7D7D8 ${percent2}%, #3A3B47 ${percent2}%)`;
    }


    function filtrarAuto(){
        periodoInicio.value = "2024-11-17"
        periodoFim.value = "2024-11-23"
        
        totem_select1.value = mxInd + 1;
        totem_select2.value = minInd + 1;

        selecionarCmp(2)

        trocarTela()

    }

    

    // Grafico barras horizontal
    function graficoBarrasHorizontal() {

        compSelecionadoParaAlertas.innerHTML = String(componente).toUpperCase()

        alertasT1 = alertasT1Cmp.innerHTML
        alertasT2 = alertasT2Cmp.innerHTML

        alertasT3 = alertasT1Total.innerHTML
        alertasT4 = alertasT2Total.innerHTML
    
        valor1 = (parseInt(alertasT3) / (parseInt(alertasT3) + parseInt(alertasT4))) * 100
        valor2 = (parseInt(alertasT4) / (parseInt(alertasT3) + parseInt(alertasT4))) * 100
        
        barra1.style.width = valor1 + "%"
        barra2.style.width = valor2 + "%"
        
        valor1 = Math.trunc(valor1)
        valor2 = Math.trunc(valor2)
        
        valor3 = (parseInt(alertasT1) / (parseInt(alertasT1) + parseInt(alertasT2))) * 100
        valor4 = (parseInt(alertasT2) / (parseInt(alertasT1) + parseInt(alertasT2))) * 100
        
        //console.log(alertasT1)
        //console.log(alertasT2)
        //console.log(valor3)
        //console.log(valor4)
        
        barra3.style.width = valor3 + "%"
        barra4.style.width = valor4 + "%"
        
        valor3 = Math.trunc(valor3)
        valor4 = Math.trunc(valor4)
        
        if (valor1 < 98){
            barra2.innerHTML = valor2 + "%"
        }

        if (valor2 < 98 ) {
            barra1.innerHTML = valor1 + "%"
        }

        if (valor4 < 99){
            barra3.innerHTML = valor3 + "%"
        }

        if (valor3 < 99) {
            barra4.innerHTML = valor4 + "%"
        }
    }
        

    function atualizarDadosT1() {
        vrTemp = "" + sliderOne.value;
        ax = ":00"
        if (sliderTwo.value == 24){
            sliderTwo.value = "23"
            ax = ":59"
        } 
        
        if (sliderOne.value < 10){
            vrTemp = "0" + sliderOne.value
            ax = ":59"
        } 

        fetch(`/totem/listarAlertaPorTotemPorDiaDaSemana/${totem1}/${componente}/${prInicio}/${prFim}/${vrTemp + ":00"}/${sliderTwo.value + ax}`, {method: "post"}).then(function (resposta) {
            if (resposta.ok) {
                if (resposta.status == 204) {
                    var feed = document.getElementById("feed_container");
                    var mensagem = document.createElement("span");
                    mensagem.innerHTML = "Nenhum resultado encontrado."
                    feed.appendChild(mensagem);
                    throw "Nenhum resultado encontrado!!";
                }

                resposta.json().then(function (resposta) {
                    //console.log("Dados recebidos: ", JSON.stringify(resposta));

                    dadosVetor = [resposta[6].qtd, resposta[0].qtd, resposta[1].qtd, resposta[2].qtd, resposta[3].qtd, resposta[4].qtd, resposta[5].qtd]

                    ctx.data.datasets[0].data = dadosVetor;

                    ctx.update();

                });
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);

        });
    }

    function atualizarDadosT2() {
        vrTemp = "" + sliderOne.value;
        ax = ":00"
        if (sliderTwo.value == 24){
            sliderTwo.value = "23"
            ax = ":59"
        } 
        
        if (sliderOne.value < 10){
            vrTemp = "0" + sliderOne.value
            ax = ":59"
        } 
        fetch(`/totem/listarAlertaPorTotemPorDiaDaSemana/${totem2}/${componente}/${prInicio}/${prFim}/${vrTemp + ":00"}/${sliderTwo.value + ax}`, {method: "post"}).then(function (resposta) {
            if (resposta.ok) {
                if (resposta.status == 204) {
                    var feed = document.getElementById("feed_container");
                    var mensagem = document.createElement("span");
                    mensagem.innerHTML = "Nenhum resultado encontrado."
                    feed.appendChild(mensagem);
                    throw "Nenhum resultado encontrado!!";
                }

                resposta.json().then(function (resposta) {
                    //console.log("Dados recebidos: ", JSON.stringify(resposta));

                    dadosVetor2 = [resposta[6].qtd, resposta[0].qtd, resposta[1].qtd, resposta[2].qtd, resposta[3].qtd, resposta[4].qtd, resposta[5].qtd]

                    ctx.data.datasets[1].data = dadosVetor2;

                    ctx.update();

                });
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);

        });
    }

    function puxarAlertasPorDia() {
        fetch(`/totem/listarAlertaPorTotem/${totem1}/${componente}/${prInicio}/${prFim}`, {method: "post"}).then(function (resposta) {
            if (resposta.ok) {
                if (resposta.status == 204) {
                    var feed = document.getElementById("feed_container");
                    var mensagem = document.createElement("span");
                    mensagem.innerHTML = "Nenhum resultado encontrado."
                    feed.appendChild(mensagem);
                    throw "Nenhum resultado encontrado!!";
                }

                resposta.json().then(function (resposta) {
                    //console.log("Dados recebidos: ", JSON.stringify(resposta));

                    dadosVetor3 = []

                    var tamanhoRsp = Object.keys(resposta).length;

                    somaAlertasT1 = 0

                    count = 0;
                    for (i = resposta[0].DIA_MES; i <= resposta[tamanhoRsp - 1].DIA_MES; i++){
                        dadosVetor3[count] = resposta[count].qtd
                        somaAlertasT1 += resposta[count].qtd
                        count++
                    }

                    ctx2.data.datasets[0].data = dadosVetor3;
                    
                    ctx2.update();

                    alertasT1Cmp.innerHTML = somaAlertasT1

                });
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);

        });
    }



    function puxarAlertasPorDia2() {
        fetch(`/totem/listarAlertaPorTotem/${totem2}/${componente}/${prInicio}/${prFim}`, {method: "post"}).then(function (resposta) {
            if (resposta.ok) {
                if (resposta.status == 204) {
                    var feed = document.getElementById("feed_container");
                    var mensagem = document.createElement("span");
                    mensagem.innerHTML = "Nenhum resultado encontrado."
                    feed.appendChild(mensagem);
                    throw "Nenhum resultado encontrado!!";
                }

                resposta.json().then(function (resposta) {
                    //console.log("Dados recebidos: ", JSON.stringify(resposta));

                    dadosVetor3 = []

                    var tamanhoRsp = Object.keys(resposta).length;

                    somaAlertasT2 = 0

                    count = 0;
                    for (i = resposta[0].DIA_MES; i <= resposta[tamanhoRsp - 1].DIA_MES; i++){
                        dadosVetor3[count] = resposta[count].qtd
                        somaAlertasT2 += resposta[count].qtd
                        count++
                    }

                    ctx2.data.datasets[1].data = dadosVetor3;
                    
                    ctx2.update();

                    alertasT2Cmp.innerHTML = somaAlertasT2

                });
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);

        });
    }

    function puxarTodosAlertas() {
        fetch(`/totem/listarTodosAlertas`, {method: "post"}).then(function (resposta) {
            if (resposta.ok) {
                if (resposta.status == 204) {
                    var feed = document.getElementById("feed_container");
                    var mensagem = document.createElement("span");
                    mensagem.innerHTML = "Nenhum resultado encontrado."
                    feed.appendChild(mensagem);
                    throw "Nenhum resultado encontrado!!";
                }

                resposta.json().then(function (resposta) {
                    //console.log("Dados recebidos: ", JSON.stringify(resposta));

                        var countTT = Object.keys(resposta).length;

                        var escada1 = { x: 38, y: 340, value: resposta[0].qtd, radius: 30, };
                        var escada2 = { x: 90, y: 340, value: resposta[1].qtd, radius: 30, };
                        var escada3 = { x: 230, y: 310, value: resposta[2].qtd, radius: 30, };
                        var escada4 = { x: 280, y: 310, value: resposta[3].qtd, radius: 30, };
                        var escada5 = { x: 230, y: 210, value: resposta[4].qtd, radius: 30, };
                        var escada6 = { x: 280, y: 210, value: resposta[5].qtd, radius: 30, };
                        
                        points = [escada1, escada2, escada3, escada4, escada5, escada6];
    
                        var data = {
                            max: max,
                            min: min,
                            data: points,
                        }

                        console.log(resposta)

                        maiorTotem = resposta[0].qtd
                        mxInd = 0

                        console.log(maiorTotem)


                        for(i = 0; i < countTT; i++){
                            if (maiorTotem < resposta[i].qtd) {
                                maiorTotem = resposta[i].qtd
                                mxInd = i
                            }
                        }
    
                        menorTotem = resposta[1].qtd
                        minInd = 1

                        for(i = 0; i < countTT; i++){
                            console.log(menorTotem, maiorTotem)
                            if(mxInd == i){}
                            else if (menorTotem < resposta[i].qtd) {
                                menorTotem = resposta[i].qtd
                                minInd = i
                            }
                        }

                        sgtTM.innerHTML = resposta[mxInd].totem

                        sgtMN.innerHTML = resposta[minInd].totem

                        heatmapInstance.setData(data);

                        //console.log("heat ",resposta);




                });
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);

        });
    }


    function puxarTodosAlertasPorTotem() {
        fetch(`/totem/puxarTodosAlertasPorTotem/${totem1}/${totem2}/${prInicio}/${prFim}`, {method: "post"}).then(function (resposta) {
            if (resposta.ok) {
                if (resposta.status == 204) {
                    var feed = document.getElementById("feed_container");
                    var mensagem = document.createElement("span");
                    mensagem.innerHTML = "Nenhum resultado encontrado."
                    feed.appendChild(mensagem);
                    throw "Nenhum resultado encontrado!!";
                }

                resposta.json().then(function (resposta) {
                    //console.log("Dados total alertas: ", JSON.stringify(resposta));
                        
                        alertasT1Total.innerHTML = resposta[(totem1 - 1)].qtd
                        alertasT2Total.innerHTML = resposta[(totem2 - 1)].qtd


                });
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);

        });
    }


    function puxarDadosBucket() {
        fetch(`/s3/viewS3`, {method: "get"}).then(function (resposta) {
            if (resposta.ok) {
                if (resposta.status == 204) {
                    var feed = document.getElementById("feed_container");
                    var mensagem = document.createElement("span");
                    mensagem.innerHTML = "Nenhum resultado encontrado."
                    feed.appendChild(mensagem);
                    throw "Nenhum resultado encontrado!!";
                }

                resposta.json().then(function (resposta) {
                    //console.log("Dados do S3: ", JSON.stringify(resposta));

                    var count = Object.keys(resposta.resultado).length;
                    //console.log("Possivel tamanho:", count);

                    // Determinar o macAddress a ser filtrado
                    const targetMacAddress = "12680cf3b36b";

                    // Filtrar e contar ocorrências onde a CPU > 85
                    const countRamInef = resposta.resultado.filter(entry => 
                    entry.macAddress === targetMacAddress && parseFloat(entry.ramPorcentagem) < 20
                    ).length;

                    const countRamIdeal = resposta.resultado.filter(entry => 
                    entry.macAddress === targetMacAddress && parseFloat(entry.ramPorcentagem) >= 20 && parseFloat(entry.ramPorcentagem) <= 85
                    ).length;

                    const countRamCrit = resposta.resultado.filter(entry => 
                    entry.macAddress === targetMacAddress && parseFloat(entry.ramPorcentagem) > 85
                    ).length;

                    //console.log(`Quantidade de vezes que a RAM esteve acima de 85%: ${countRamInef}`);
                    //console.log(`Quantidade de vezes que a RAM esteve acima de 85%: ${countRamIdeal}`);
                    //console.log(`Quantidade de vezes que a RAM esteve acima de 85%: ${countRamCrit}`);
                    
                    simuInef = countRamInef + 20
                    simuIdeal = countRamIdeal
                    simuCrit = countRamCrit + 20
                        
                    dadosStatusRam = [simuCrit, simuIdeal * 0.7, simuInef]
                    ctx3.data.datasets[0].data = dadosStatusRam;

                    // let countRamInef2 = 20
                    // let countRamIdeal2 = 70
                    // let countRamCrit2 = 10

                    dadosStatusRam2 = [simuInef * 1.1, simuIdeal * 1.3, simuCrit * 1.8]
                    // dadosStatusRam2 = [countRamInef * 0.8, countRamIdeal * 1.5, countRamCrit * 1.2]
                    ctx4.data.datasets[0].data = dadosStatusRam2;

                    ctx3.update()
                    ctx4.update()
                });
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);

        });
    }



    function puxarDadosBucketCPU() {
        fetch(`/s3/viewS3`, {method: "get"}).then(function (resposta) {
            if (resposta.ok) {
                if (resposta.status == 204) {
                    var feed = document.getElementById("feed_container");
                    var mensagem = document.createElement("span");
                    mensagem.innerHTML = "Nenhum resultado encontrado."
                    feed.appendChild(mensagem);
                    throw "Nenhum resultado encontrado!!";
                }

                resposta.json().then(function (resposta) {
                    //console.log("Dados do S3: ", JSON.stringify(resposta));

                    var count = Object.keys(resposta.resultado).length;
                    //console.log("Possivel tamanho:", count);

                    // Determinar o macAddress a ser filtrado
                    const targetMacAddress = "12680cf3b36b";

                    // Filtrar e contar ocorrências onde a CPU > 85
                    const countCpuInef = resposta.resultado.filter(entry => 
                    entry.macAddress === targetMacAddress && parseFloat(entry.cpuPorcentagem) < 20
                    ).length;

                    const countCpuIdeal = resposta.resultado.filter(entry => 
                    entry.macAddress === targetMacAddress && parseFloat(entry.cpuPorcentagem) >= 20 && parseFloat(entry.cpuPorcentagem) <= 85
                    ).length;

                    const countCpuCrit = resposta.resultado.filter(entry => 
                    entry.macAddress === targetMacAddress && parseFloat(entry.cpuPorcentagem) > 85
                    ).length;

                    //console.log(`Quantidade de vezes que a Cpu esteve acima de 85%: ${countCpuInef}`);
                    //console.log(`Quantidade de vezes que a Cpu esteve acima de 85%: ${countCpuIdeal}`);
                    //console.log(`Quantidade de vezes que a Cpu esteve acima de 85%: ${countCpuCrit}`);
                        
                    simuInef = countCpuInef + 20
                    simuIdeal = countCpuIdeal
                    simuCrit = countCpuCrit + 20

                    dadosStatusCpu = [simuCrit, simuIdeal, simuInef]
                    ctx3.data.datasets[0].data = dadosStatusCpu;

                    // dadosStatusCpu2 = [countCpuInef * 0.8, countCpuIdeal * 1.5, countCpuCrit * 1.2]
                    dadosStatusCpu2 = [simuCrit * 1.1, simuIdeal * 1.5, simuInef * 0.8]
                    ctx4.data.datasets[0].data = dadosStatusCpu2;

                    ctx3.update()
                    ctx4.update()
                });
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);

        });
    }



</script>