<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MarketSafe | Dashboard</title>
    <link rel="stylesheet" href="dash.css">
    <link rel="icon" href="css/icon.png">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.0.0/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.0.0/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-wordcloud"></script>

</head>

<body>
    <div class="header">
        <ul class="navbar">
            <li><a href="perfilAnalista.html">Perfil</a></li>
            <li><a>|</a></li>
            <li class="agora"><a href="dash_analista.html">Dashboard</a></li>
            <li><a>|</a></li>
            <li><a href="">Ajuda</a></li>
            <li><a>|</a></li>
            <li><a href="index.html">Sair</a></li>
        </ul>
    </div>
    <div class="container">
        <div class="menu">
            <div class="perfil">
                <img src="../public/assets/img/foto-gerente.jpg" alt="Foto Perfil">
                <h2>Vitor</h2>
                <p>Gerente</p>
            </div>
            <div class="engloba-itens">
                <div class="regiao-select">
                    <label for="region">Componente</label>
                    <select id="region">
                        <option value="">Selecione uma opção</option>
                        <option id="1" value="1">Processador</option>
                        <option value="2">Memória</option>
                    </select>
                </div>
            </div>
            <div class="engloba-itens2">
                <div class="filial-select">
                    <label for="filial">Filial Selecionadas</label>
                    <select id="filial">
                        <option value="" selected>Selecione uma opção</option>
                        <option value="1">Filial 1</option>
                        <option value="2">Filial 2</option>
                    </select>
                    <select id="filial2">
                        <option value="" selected>Selecione uma opção</option>
                        <option value="1">Filial 1</option>
                        <option value="2">Filial 2</option>
                    </select>
                </div>
                <div id="conteudo1" class="data-select">
                    <div class="data-select">
                        <div class="mudar-periodo">
                            <div>
                                <label for="periodo">Período</label>
                            </div>
                            <div class="seta-dash">
                                <img id="novaTroca" src="./css/seta-dash.svg" alt="">
                            </div>
                        </div>
                        <div class="periodo-select">
                            <select id="opts-select">
                                <option>Selecione uma opção</option>
                                <option value="mes"> Mês</option>
                                <option value="semana">Semana</option>
                                <option value="ano">Ano</option>
                            </select>
                        </div>

                        <div class="filtros">        
                            <div class="wrapper">
                                <div class="values">
                                    <span id="range1">
                                        0
                                    </span>
                                    <span> &dash; </span>
                                    <span id="range2">
                                        100
                                    </span>
                                </div>
                                <div class="sliderContainer">
                                    <div class="slider-track"></div>
                                    <input type="range" min="0" max="23" value="10" id="slider-1" oninput="slideOne()">
                                    <input type="range" min="0" max="23" value="12" id="slider-2" oninput="slideTwo()">
                                    <!-- <input type="range" min="0" max="23" value="10" id="slider-1" oninput="slideOne(), atualizarFeed()"> -->
                                    <!-- <input type="range" min="0" max="23" value="12" id="slider-2" oninput="slideTwo(), atualizarFeed()"> -->
                                </div>
                            </div>
                        </div>

                    </div>    
                </div>

                <div>
                </div>

                <button onclick="comparar()" class="botao-comparar">COMPARAR</button>
            </div>
        </div>

        <div class="dashes">
            <div class="container-dashes">
                <h3>3 Filiais com mais alertas (no mês)</h3>
                <div class="ranking">
                    <table>
                        <tr>
                            <th>Posição</th>
                            <th>Filial Bairro</th>
                            <th>Quantidade</th>
                        </tr>
                        <tr class="highlight">
                            <td>1</td>
                            <td>Paulista</td>
                            <td>19</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>Água Rasa</td>
                            <td>12</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>Pinheiros</td>
                            <td>9</td>
                        </tr>
                    </table>
                    <!-- <div class="primeira_linha_graficos">
                    <div class="div_para_graficos">
                        <div class="graficoCPU">
                            <canvas id="cpuChart"></canvas>
                        </div>
                        <div class="graficoRAM">
                            <canvas id="ramChart"></canvas>
                        </div>
                    </div> -->
                    <div class="totens">
                        <h3>Quantidade de Filiais</h1>
                            <div class="totens-quantidade">
                                8
                            </div>
                            <h4>Nº de filiais com alertas ativos</h4>
                            <div class="totens-problema">
                                4 </div>
                    </div>
                </div>
            </div>
                <div class="dashes-baixo">
                    <div class="radar-container">
                        <span class="span_graf">Alertas por Zonas (no dia)</span>
                        <canvas id="radarChart">

                        </canvas>
                    </div>
                    <div class="grafico_wordcloud">
                        <h3>Word Cloud - Bairros de São Paulo</h3>
                        <div class="wordcloud-container">
                            <canvas id="wordCloudChart" style="width:100%; height:350px;"></canvas> 
                        </div>
                    </div>

                </div>
            </div>
        </div>

    </div>
    </div>

</body>

</html>

<script>

    function comparar() {

        const primeira_linha_graficos = document.getElementById('primeira_linha_graficos');
        const dashes_baixo = document.getElementById('dashes-baixo');

        var region = region.value;
        var filial = filial.value;
        var filial2 = filial2.value;

        if (region == 2 && filial == 2 && filial2 == 2) {
            grafico1.style.display = 'none';
            grafico2.style.display = 'none';
        }

    }


    
    // const trocaConteudo = document.getElementById('troca');
    // const trocaConteudo2 = document.getElementById('novaTroca');
    // const conteudo1 = document.getElementById('conteudo1');
    // const conteudo2 = document.getElementById('conteudo2');

    // trocaConteudo.addEventListener('click', function () {
    //     conteudo2.style.display = 'block';
    //     conteudo1.style.display = 'none';

    // });

    // trocaConteudo2.addEventListener('click', function () {
    //     conteudo1.style.display = 'block';
    //     conteudo2.style.display = 'none';

    // });

    // const cpuCtx = document.getElementById('cpuChart').getContext('2d');
    // const cpuChart = new Chart(cpuCtx, {
    //     type: 'bar',
    //     data: {
    //         labels: ['Filial 1', 'Filial 4', 'Filial 6'],
    //         datasets: [{
    //             label: 'CPU',
    //             data: [80, 50, 70],
    //             backgroundColor: 'orange',
    //             borderWidth: 1
    //         }]
    //     },
    //     options: {
    //         scales: {
    //             y: {
    //                 beginAtZero: true,
    //                 max: 100,
    //                 ticks: {
    //                     callback: function (value) {
    //                         return value;
    //                     }
    //                 }
    //             }
    //         }
    //     }
    // });

    // // Gráfico de RAM
    // const ramCtx = document.getElementById('ramChart').getContext('2d');
    // const ramChart = new Chart(ramCtx, {
    //     type: 'bar',
    //     data: {
    //         labels: ['Filial 6', 'Filial 2', 'Filial 1'],
    //         datasets: [{
    //             label: 'RAM',
    //             data: [60, 90, 70],
    //             backgroundColor: 'red',
    //             borderWidth: 1
    //         }]
    //     },
    //     options: {
    //         scales: {
    //             y: {
    //                 beginAtZero: true,
    //                 max: 100,
    //                 ticks: {
    //                     callback: function (value) {
    //                         return value;
    //                     }
    //                 }
    //             }
    //         }
    //     }
    // });

    
    // Radar Chart
    const radarCtx = document.getElementById('radarChart').getContext('2d');
    const dataRadar = {
      labels: [
        'Central',
        'Norte',
        'Sul',
        'Oeste',
        'Leste'
      ],
      datasets: [{
        label: 'Alertas(???)', // TODO: Trocar o nome dessa label
        data: [78, 55, 90, 75, 80],
        fill: false,
        borderColor: '#FF3131'
      }]
    };

    const configRadar = {
    type: 'radar',
    data: dataRadar,
    options: {
        elements: {
            line: {
                borderWidth: 3
            }
        },
        scales: {
            r: {
                grid: {
                    color: '#CCCCCC',
                    circular: true
                },
                angleLines: {
                    color: '#CCCCCC'
                },
                min: 0,
                max: 100,
                ticks: {
                    stepSize: 25,
                    color: 'white',
                    showLabelBackdrop: false
                },
                pointLabels: {
                    color: 'white'
                }
            }
        },
        plugins: {
            legend: {
                display: false
            }
        }
    }
    };

    let radar = new Chart(
        document.getElementById('radarChart'),
        configRadar
    );

    window.onload = function () {
    slideOne();
    slideTwo();
  };
  
  let sliderOne = document.getElementById("slider-1");
  let sliderTwo = document.getElementById("slider-2");
  let displayValOne = document.getElementById("range1");
  let displayValTwo = document.getElementById("range2");
  let minGap = 1;
  let sliderTrack = document.querySelector(".slider-track");
  let sliderMaxValue = document.getElementById("slider-1").max;
  
  function slideOne() {
    if (parseInt(sliderTwo.value) - parseInt(sliderOne.value) <= minGap) {
      sliderOne.value = parseInt(sliderTwo.value) - minGap;
    }
    if (sliderOne.value < 10) displayValOne.textContent = '0' + sliderOne.value + ':00';
    else displayValOne.textContent = sliderOne.value + ':00 ';
    fillColor();
  }
  function slideTwo() {
    if (parseInt(sliderTwo.value) - parseInt(sliderOne.value) <= minGap) {
      sliderTwo.value = parseInt(sliderOne.value) + minGap;
    }
    if (sliderTwo.value < 10) displayValTwo.textContent = '0' + sliderTwo.value + ':00';
    else displayValTwo.textContent = sliderTwo.value + ':00';
    fillColor();
  }
  function fillColor() {
    percent1 = (sliderOne.value / sliderMaxValue) * 100;
    percent2 = (sliderTwo.value / sliderMaxValue) * 100;
    sliderTrack.style.background = `linear-gradient(to right, #b3b3bd ${percent1}% , #144b97 ${percent1}% , #144b97 ${percent2}%, #b3b3bd ${percent2}%)`;
  }

</script>