<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MarketSafe | Dashboard</title>
    <link rel="stylesheet" href="dash.css">
    <link rel="icon" href="css/icon.png">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.0.0/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.0.0/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-wordcloud"></script>

</head>

<body>
    <div class="header">
        <ul class="navbar">
            <li><a href="perfilAnalista.html">Perfil</a></li>
            <li><a>|</a></li>
            <li class="agora"><a href="dash_analista.html">Dashboard</a></li>
            <li><a>|</a></li>
            <li><a href="">Ajuda</a></li>
            <li><a>|</a></li>
            <li><a href="index.html">Sair</a></li>
        </ul>
    </div>
    <div class="container">
        <div class="menu">
            <div class="perfil">
                <img src="../public/assets/img/foto-gerente.jpg" alt="Foto Perfil">
                <h2>Vitor</h2>
                <p>Gerente</p>
            </div>
            <div class="engloba-itens">
                <div class="regiao-select">
                    <label for="region">Componente</label>
                    <select id="region">
                        <option value="">Selecione uma opção</option>
                        <option id="1" value="1">Processador</option>
                        <option value="2">Memória</option>
                    </select>
                </div>
            </div>
            <div class="engloba-itens2">
                <div class="filial-select">
                    <label for="filial">Filial Selecionadas</label>
                    <select id="filial">
                        <option value="" selected>Selecione uma opção</option>
                        <option value="1">Filial 1</option>
                        <option value="2">Filial 2</option>
                    </select>
                    <select id="filial2">
                        <option value="" selected>Selecione uma opção</option>
                        <option value="1">Filial 1</option>
                        <option value="2">Filial 2</option>
                    </select>
                </div>
                <div id="conteudo1" class="data-select">
                    <div class="mudar-periodo">
                        <div>
                            <label for="start-date">Período</label>
                        </div>
                        <div class="seta-dash">
                            <img id="troca" src="./css/seta-dash.svg" alt="">
                        </div>
                    </div>
                    <div class="campo-datas">
                        <input type="date" id="start-date">
                        <input type="date" id="end-date">
                    </div>
                </div>

                <div id="conteudo2" style="display: none;">
                    <div class="data-select">
                        <div class="mudar-periodo">
                            <div>
                                <label for="periodo">Período</label>
                            </div>
                            <div class="seta-dash">
                                <img id="novaTroca" src="./css/seta-dash.svg" alt="">
                            </div>
                        </div>
                        <div class="periodo-select">
                            <select id="opts-select">
                                <option>Selecione uma opção</option>
                                <option value="mes"> Mês</option>
                                <option value="semana">Semana</option>
                                <option value="ano">Ano</option>
                            </select>
                        </div>
                    </div>
                </div>

                <button onclick="comparar()" class="botao-comparar">COMPARAR</button>
            </div>
        </div>

        <div class="dashes">
            <div class="container-dashes">
                <h3>3 Filiais com mais alertas (no dia)</h3>
                <div class="primeira_linha_graficos">
                    <div class="div_para_graficos">
                        <div class="graficoCPU">
                            <canvas id="cpuChart"></canvas>
                        </div>
                        <div class="graficoRAM">
                            <canvas id="ramChart"></canvas>
                        </div>
                    </div>
                    <div class="totens">
                        <h3>Quantidade de Filiais</h1>
                            <div class="totens-quantidade">
                                8
                            </div>
                            <h4>Nº de filiais com problema</h4>
                            <div class="totens-problema">
                                4 </div>
                    </div>
                </div>
                <div class="dashes-baixo">
                    <div class="radar-container">
                        <span class="span_graf">Alertas por Zonas (no dia)</span>
                        <canvas id="radarChart">

                        </canvas>
                    </div>
                    <div class="grafico_wordcloud">
                        <h3>Word Cloud - Bairros de São Paulo</h3>
                        <div class="wordcloud-container">
                            <canvas id="wordCloudChart" style="width:100%; height:350px;"></canvas>
                        </div>
                    </div>

                </div>
            </div>
        </div>

    </div>
    </div>

</body>

</html>

<script>

    function comparar() {

        const primeira_linha_graficos = document.getElementById('primeira_linha_graficos');
        const dashes_baixo = document.getElementById('dashes-baixo');

        var region = region.value;
        var filial = filial.value;
        var filial2 = filial2.value;

        if (region == 2 && filial == 2 && filial2 == 2) {
            grafico1.style.display = 'none';
            grafico2.style.display = 'none';
        }

    }



    const trocaConteudo = document.getElementById('troca');
    const trocaConteudo2 = document.getElementById('novaTroca');
    const conteudo1 = document.getElementById('conteudo1');
    const conteudo2 = document.getElementById('conteudo2');

    trocaConteudo.addEventListener('click', function () {
        conteudo2.style.display = 'block';
        conteudo1.style.display = 'none';

    });

    trocaConteudo2.addEventListener('click', function () {
        conteudo1.style.display = 'block';
        conteudo2.style.display = 'none';

    });

    const cpuCtx = document.getElementById('cpuChart').getContext('2d');
    const cpuChart = new Chart(cpuCtx, {
        type: 'bar',
        data: {
            labels: ['Filial 1', 'Filial 4', 'Filial 6'],
            datasets: [{
                label: 'CPU',
                data: [80, 50, 70],
                backgroundColor: 'orange',
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true,
                    max: 100,
                    ticks: {
                        callback: function (value) {
                            return value;
                        }
                    }
                }
            }
        }
    });

    // Gráfico de RAM
    const ramCtx = document.getElementById('ramChart').getContext('2d');
    const ramChart = new Chart(ramCtx, {
        type: 'bar',
        data: {
            labels: ['Filial 6', 'Filial 2', 'Filial 1'],
            datasets: [{
                label: 'RAM',
                data: [60, 90, 70],
                backgroundColor: 'red',
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true,
                    max: 100,
                    ticks: {
                        callback: function (value) {
                            return value;
                        }
                    }
                }
            }
        }
    });

    /*

        IMPORTANTE: O WORD CLOUD FOI COMENTADO POIS IMPEDIA O PLOT DO RADAR.

    */

    // Word Cloud Chart
    // const wordCloudCtx = document.getElementById('wordCloudChart').getContext('2d');

    // const dataWordCloud = {
    //     labels: [
    //         "ÁguaRasa", "AltodePinheiros", "Anhanguera", "Aricanduva", "ArturAlvim",
    //         "BarraFunda", "BelaVista", "Belém", "BomRetiro", "Brasilândia",
    //         "Butantã", "Cachoeirinha", "Cambuci", "CampoBelo", "CampoGrande",
    //         "CampoLimpo", "Cangaíba", "CapãoRedondo", "Carrão", "CasaVerde",
    //         "CidadeAdemar", "CidadeDutra", "CidadeLíder", "CidadeTiradentes",
    //         "Consolação", "Cursino", "ErmelinoMatarazzo", "FreguesiadoÓ", "Grajaú",
    //         "Guaianases", "Iguatemi", "Ipiranga", "ItaimBibi", "ItaimPaulista",
    //         "Itaquera", "Jabaquara", "Jaçanã", "Jaguara", "Jaguaré", "Jaraguá",
    //         "JardimÂngela", "JardimHelena", "JardimPaulista", "JardimSãoLuís",
    //         "Lapa", "Liberdade", "Limão", "Mandaqui", "Marsilac", "Moema",
    //         "Mooca", "Morumbi", "Parelheiros", "Pari", "ParquedoCarmo", "Penha",
    //         "Perdizes", "Pinheiros", "PonteRasa", "RaposoTavares", "República",
    //         "RioPequeno", "Sacomã", "SantaCecília", "Santana", "SantoAmaro",
    //         "SãoDomingos", "SãoLucas", "SãoMateus", "SãoMiguelPaulista",
    //         "SãoRafael", "Sapopemba", "Saúde", "Sé", "Tatuapé", "Tremembé",
    //         "Tucuruvi", "VilaAndrade", "VilaCuruçá", "VilaFormosa", "VilaGuilherme",
    //         "VilaJacuí", "VilaLeopoldina", "VilaMaria", "VilaMariana", "VilaMatilde",
    //         "VilaMedeiros", "VilaPrudente", "VilaSônia"
    //     ],
    //     datasets: [{
    //         label: 'Quantidade de Alertas:',
    //         data: [10, 9, 12, 14, 7, 8, 10, 9, 11, 12, 13, 10, 8, 14, 11, 13, 7, 12, 9, 10],
    //         padding: 1,
    //         color: function (context) {
    //             const index = context.dataIndex;
    //             const value = context.dataset.data[index];
    //             const max = Math.max(...context.dataset.data);
    //             const min = Math.min(...context.dataset.data);
    //             const percent = (value - min) / (max - min);
    //             const colors = ['#FF5733', '#FFBD33', '#33FF57', '#3375FF']; //cores
    //             return colors[Math.floor(percent * (colors.length - 1))];
    //         },
    //         size: function (context) {
    //             const index = context.dataIndex;
    //             const value = context.dataset.data[index];
    //             return value * 1.5; //dar mais destaque nas palvras
    //         }
    //     }]
    // };
    // const optionsWordCloud = {
    //     plugins: {
    //         legend: { display: false }
    //     },
    //     layout: {
    //         fit: true
    //     },
    //     title: {
    //         display: true,
    //         text: 'Bairros de São Paulo'
    //     }
    // };

    // new Chart(wordCloudCtx, {
    //     type: 'wordCloud',
    //     data: dataWordCloud,
    //     options: optionsWordCloud
    // });

    // Radar Chart
    const radarCtx = document.getElementById('radarChart').getContext('2d');
    const dataRadar = {
      labels: [
        'Central',
        'Norte',
        'Sul',
        'Oeste',
        'Leste'
      ],
      datasets: [{
        label: 'Alertas(???)', // TODO: Trocar o nome dessa label
        data: [78, 55, 90, 75, 80],
        fill: false,
        borderColor: '#FF3131'
      }]
    };

    const configRadar = {
    type: 'radar',
    data: dataRadar,
    options: {
        elements: {
            line: {
                borderWidth: 3
            }
        },
        scales: {
            r: {
                grid: {
                    color: '#CCCCCC',
                    circular: true
                },
                angleLines: {
                    color: '#CCCCCC'
                },
                min: 0,
                max: 100,
                ticks: {
                    stepSize: 25,
                    color: 'white',
                    showLabelBackdrop: false
                },
                pointLabels: {
                    color: 'white'
                }
            }
        },
        plugins: {
            legend: {
                display: false
            }
        }
    }
    };

    let radar = new Chart(
        document.getElementById('radarChart'),
        configRadar
    );

</script>